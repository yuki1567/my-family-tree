# 要件定義書

## 1. 機能要件

### 1.1 人物管理機能

#### 人物情報管理

**全て任意項目**

- 氏名（姓・名）※空の場合は「不明」「父」「母」等のデフォルト表示
- 性別
- 生年月日
- 没年月日
- 出生地
- プロフィール写真
- メモ・エピソード（自由記述）

#### 基本操作

- 人物の新規追加
- 人物情報の編集
- 人物の削除（関係性の確認付き）
- 無名人物対応

### 1.2 関係性管理機能

#### 関係設定

- 親子関係の設定
- 養子・養女関係の設定
- 関係の編集・削除機能

#### データ操作

- 関係の追加・削除
- 関係性の一覧表示
- 関係の検証機能

### 1.3 家系図可視化機能

#### 表示機能

- **標準表示**: 縦型家系図（上が先祖、下が子孫）
- **表示オプション**
  - 世代数の制限（3 世代、5 世代、全世代）
  - 特定人物を中心とした表示
  - 男女別の色分け表示

#### 操作機能

- ズーム機能（拡大・縮小）
- パン機能（ドラッグでの移動）
- 人物ボックスのクリック処理
- 関係線の表示・非表示切り替え

### 1.4 検索機能（Phase 2）

#### 基本検索

- 人物名による検索（部分一致）
- 検索結果のハイライト表示

#### 詳細検索

- 生年・没年での期間検索
- 出生地での検索
- 性別での絞り込み

#### 関係性検索

- 特定人物の親・子・兄弟姉妹の表示
- 世代をさかのぼっての検索

### 1.5 データ管理機能

#### データ保存

- **Phase 1**: LocalStorage でのデータ保存
- **Phase 2**: MySQL + AWS S3 での永続化

#### データ出力

- 家系図データの JSON 形式出力
- データのバックアップ機能
- データのインポート機能

## 2. 非機能要件

### 2.1 パフォーマンス

- ページ読み込み時間：3 秒以内
- 検索結果表示：1 秒以内
- 同時管理可能人数：500 人程度
- 家系図描画時間：1 秒以内（100 人まで）

### 2.2 ユーザビリティ

- 直感的な操作性
- エラーメッセージの分かりやすさ
- ヘルプ・チュートリアル機能
- レスポンシブデザイン対応

### 2.3 セキュリティ・データ管理

- **Phase 1**: ローカルストレージでのデータ保存
- **Phase 2**: AWS S3 でのデータ管理
- データの暗号化
- 不正アクセス対策
- S3 アクセス権限管理

### 2.4 拡張性

- 将来的な機能追加への対応
- データ形式の互換性維持
- AWS サービス拡張への対応（認証、バックアップ等）

## 3. 画面構成

### 3.1 メイン画面（SPA: Single Page Application）

- ヘッダー（アプリ名、メニュー）
- 家系図表示エリア（メインコンテンツ）
- 操作パネル（ズーム、表示設定）
- フローティング検索ボタン

### 3.2 モーダル画面（レスポンシブ対応）

- **人物詳細モーダル**
  - 人物情報表示・編集フォーム
  - 関係性設定エリア
  - 写真アップロード機能
  - スマートフォン：フルスクリーン表示
  - PC・タブレット：オーバーレイ表示
- **設定モーダル**
  - 表示設定
  - データ管理（バックアップ・復元・S3 同期）
  - ヘルプ・使い方ガイド
- **検索モーダル**
  - 基本・詳細検索フォーム
  - 検索結果一覧

## 4. 開発フェーズ

### 開発アプローチの特徴

#### 機能完結型開発

- **段階的機能実装**: 一つの機能を完全に仕上げてから次へ
- **API先行開発**: バックエンドから段階的にフロントエンドへ
- **視覚確認重視**: デザイン先行でUI/UX検証
- **継続的検証**: 各ステップでの動作確認

#### 機能単位開発サイクル（6ステップ）

```
1. API開発
   ↓
2. サーバーサイド単体テスト作成
   ↓
3. APIテスト作成
   ↓
4. フロントエンド画面デザイン作成（静的表示確認）
   ↓
5. フロントエンドビジネスロジック作成
   ↓
6. フロントエンドテストコード作成

```

### 実装優先順位

1. **人物追加機能**（最基盤）
2. **人物詳細機能**
3. **人物編集機能**
4. **人物削除機能**
5. **人物一覧機能**
6. **関係性管理機能**
7. **家系図表示機能**
8. **家系図操作機能**
9. **人物検索機能**
10. **人物写真アップロード機能**
11. **データのエクスポート機能**
12. **データのインポート機能**
