# コーディング規約

## 1. 基本原則

- **可読性優先**: コードは書く時間より読む時間の方が長い
- **一貫性**: プロジェクト全体で統一されたスタイル
- **シンプルさ**: 複雑さを避け、明確で理解しやすいコード
- **型安全性**: TypeScript strict modeを活用した堅牢なコード

> **コーディング規約（自動適用）**: `.claude/rules/coding-standards.md` を参照
> **コード品質ツール**: `.claude/rules/code-quality.md` を参照

## 2. TypeScript規約

### 2.1 基本ルールの設計理由

| ルール | 理由 |
|--------|------|
| strict: true | 保守性最優先。noImplicitAny、strictNullChecks等を一括有効化 |
| any型禁止 → unknown | 型安全性を損なわない。unknownは使用前に型チェックを強制 |
| type推奨 > interface | Union Types、Mapped Typesとの親和性。プロジェクト全体の統一 |
| enum使用禁止 → Union Types | Tree-shakingの効果、型の柔軟性、ランタイムコード不要 |
| 明示的な戻り値型 | 関数の意図を明確化。リファクタリング時の安全性向上 |
| 型アサーション（as）禁止 | 型安全性を損なう。代替: 型ガード、Zodバリデーション、型の絞り込み。`as const`のみ例外許可 |
| readonlyの活用 | 意図しない変更の防止。不変性の明示 |
| ユーティリティ型活用 | Omit、Partial、Pickで手動再定義を回避 |

### 2.2 プログラミングパラダイムの設計判断

**バックエンド**: オブジェクト指向と関数型の使い分け

| 対象層 | スタイル | 理由 |
|--------|---------|------|
| services/, repositories/ | クラスベース（OOP + DI） | 依存性注入、状態管理、テスタビリティ |
| routes/, middlewares/, utils/, config/ | アロー関数（関数型） | 純粋関数、小さな再利用関数中心 |

**フロントエンド**: 全てアロー関数（関数型）。コンポーネント内状態やユーティリティ関数中心、Composition APIとの親和性。

### 2.3 エラーハンドリングの設計理由

- async関数は必ずtry-catchで囲む
- エラーは型安全に処理（unknown型でキャッチ）
- 適切なエラーメッセージで障害調査を容易にする

## 3. Vue.js規約

### 3.1 コンポーネント構造の設計理由

`<script setup lang="ts">`を採用。セクション順序の理由：

| 順序 | セクション | 理由 |
|------|-----------|------|
| 1 | imports | 依存関係を最初に把握 |
| 2 | Props/Emits（type定義） | コンポーネントのインターフェースを明示 |
| 3 | リアクティブデータ | コンポーネントの状態定義 |
| 4 | 算出プロパティ | 状態の派生データ |
| 5 | ウォッチャー | 状態変更の副作用 |
| 6 | メソッド | ユーザーアクション |

### 3.2 Props/Emitsの型安全性

- `withDefaults(defineProps<Props>(), ...)`で型付きPropsとデフォルト値
- `defineEmits<Emits>()`で型付きイベント（配列形式は型なしのため禁止）
- `data-testid`属性でテスタブルな要素を明示

### 3.3 コンポーネント命名の理由

PascalCaseを採用。理由: Vue公式推奨、テンプレート内での識別性向上、HTMLタグとの明確な区別。

## 4. 命名規則の設計理由

| 対象 | スタイル | 理由 |
|------|---------|------|
| 変数・関数 | camelCase | JavaScript標準慣行 |
| 定数 | UPPER_SNAKE_CASE | 変更不可能な値を視覚的に区別 |
| 型・クラス | PascalCase | TypeScript標準慣行 |
| Vueコンポーネント | PascalCase（ファイル名） | Vue公式推奨 |
| CSSクラス | kebab-case | CSS標準慣行、HTMLとの統一 |
| Storeファイル | lowercase | ディレクトリとの統一 |
| DBカラム | snake_case | PostgreSQL標準慣行 |

## 5. インポート順序

Biome `organizeImports`で自動整形。手動管理不要。

順序: Node.js組み込み → 外部ライブラリ → プロジェクト内モジュール（各グループ内はアルファベット順）

## 6. コメント・ドキュメント

### 6.1 コメントの設計思想

「コードを読めばわかる内容はコメントしない」

コメントはコードでは表現できない「なぜ」「背景」「意図」のみ。不要なコメントは可読性を損なう。

### 6.2 必要なコメント

- ビジネスルールの背景説明
- 技術的制約の説明（パフォーマンス要件等）
- 外部要因の説明（外部API仕様等）
- 公開APIのTSDocコメント（複雑なロジックの背景）

### 6.3 禁止されるコメント

- コードから明らかな内容（「今日の日付を取得」等）
- 曖昧なTODO/FIXME（具体的な行動計画なし）
- テストのArrange/Act/Assertコメント
