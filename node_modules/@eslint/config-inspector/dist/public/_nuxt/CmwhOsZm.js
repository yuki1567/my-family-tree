import{e as W,i as P,k as O,w as N,n as L,Z as Oe,o as p,c as g,t as B,q as Te,s as k,p as x,a as v,$ as Fe,S as ne,D as re,h as De,b as K,F as S,d as ie,l as H,B as Pe,a0 as Ve,T as je,v as Be,x as We,U as X,y as Y,a1 as J,_ as ze,z as te,W as Ke,a2 as He}from"./Dwuha7_F.js";import{g as Ge,s as ge,c as Ue,_ as Ye,a as Je}from"./oPRW2QIO.js";const Qe={key:1,op30:""},Xe={key:2},Ze={op75:""},qe=W({__name:"ColorizedRuleName",props:{name:{},prefix:{},url:{},as:{},deprecated:{type:Boolean},borderless:{type:Boolean},break:{type:Boolean}},setup(t){const e=t,s=P(()=>{if(e.prefix)return e.name.startsWith(e.prefix)?{scope:e.prefix,name:e.name.slice(e.prefix.length).replace(/^\/+/,"")}:{scope:void 0,name:e.name};const r=e.name.split("/");return r.length===1?{scope:void 0,name:r[0]}:{scope:r[0],name:r.slice(1).join("/")}});return(r,o)=>(p(),O(Oe(r.as||"div"),{"of-hidden":"","text-ellipsis":"","ws-nowrap":"","font-mono":"",class:L([r.deprecated?"line-through":"",r.borderless?"":"badge"])},{default:N(()=>[s.value.scope?(p(),g("span",{key:0,style:Te({color:("getPluginColor"in r?r.getPluginColor:k(Ge))(s.value.scope)})},B(s.value.scope),5)):x("",!0),s.value.scope?(p(),g("span",Qe,"/")):x("",!0),s.value.scope&&e.break?(p(),g("br",Xe)):x("",!0),v("span",Ze,B(s.value.name),1)]),_:1},8,["class"]))}});function Me(t){const e=`${t}`;return e.endsWith("1")&&t!==11?`${e}st`:e.endsWith("2")&&t!==12?`${e}nd`:e.endsWith("3")&&t!==13?`${e}rd`:`${t}th`}function et(t){return JSON.stringify(t,null,2).replace(/"(\w+)":/g,"$1:").replace(/"/g,"'")}const tt=["title"],st={key:0,absolute:"","right--2px":"","top--2px":"","h-6px":"","w-6px":"","rounded-full":"","bg-current":"",op75:""},ke=W({__name:"RuleLevelIcon",props:{level:{},hasOptions:{type:Boolean},configIndex:{},class:{}},setup(t){const e=t,s=P(()=>e.configIndex==null?`Enabled as '${e.level}'`:`Enabled as '${e.level}', in the ${Me(e.configIndex+1)} config item`),r=P(()=>({error:"text-red op80",warn:"text-yellow5 op80 dark:text-yellow4",off:"text-gray op50"})[e.level]),o=P(()=>({error:"i-ph-warning-circle-duotone",warn:"i-ph-warning-duotone",off:"i-ph-circle-half-tilt-duotone"})[e.level]);return(l,n)=>(p(),g("div",{relative:"",class:L([r.value,e.class]),title:s.value},[v("div",{class:L(o.value)},null,2),l.hasOptions?(p(),g("div",st)):x("",!0)],10,tt))}}),nt=W({name:"Shiki",props:{code:{type:String,required:!0},lang:{type:String,required:!0}},setup(t){const e=P(()=>ge.value?ge.value.codeToHtml(t.code,{lang:t.lang,theme:Fe.value?"vitesse-dark":"vitesse-light",transformers:[{pre(s){s.properties.style=""}}]}):Ue(t.code));return()=>ne("div",{class:"filter-hue-rotate-90",innerHTML:e.value})}}),rt={"min-w-100":"",p4:"",flex:"~ col gap-2"},it={flex:"~ gap-1 items-center"},ot={key:0,ml1:"",op50:""},lt={key:1,ml1:"",op50:""},ct={key:3,op50:""},at={key:0,flex:"~ gap-2"},ut={flex:"~ col gap-2"},ht={flex:"~ gap-2 items-center wrap"},be=W({__name:"RuleStateItem",props:{state:{},isLocal:{type:Boolean}},setup(t){const e=t,s={error:"text-red",warn:"text-amber",off:"text-gray"},r=P(()=>re.value.configs[e.state.configIndex]),o=De();function l(){Pe.rule=e.state.name,o.push("/configs")}return(n,i)=>{var f,m;const c=ke,a=Ye,u=Je,h=nt;return p(),g("div",rt,[v("div",it,[K(c,{level:n.state.level,"config-index":n.state.configIndex},null,8,["level","config-index"]),n.state.level==="off"?(p(),g("span",ot,"Turned ")):(p(),g("span",lt,"Set to ")),v("span",{"font-mono":"",class:L(s[n.state.level])},B(n.state.level),3),n.isLocal?(p(),g("div",ct," in this config ")):(p(),g(S,{key:2},[i[3]||(i[3]=v("span",{op50:""},"in",-1)),v("button",{hover:"!color-base","text-gray":"",onClick:i[0]||(i[0]=y=>l())},[r.value.name?(p(),O(a,{key:0,name:r.value.name,px2:"","font-mono":"",border:"~ base rounded"},null,8,["name"])):x("",!0),i[1]||(i[1]=v("span",{op50:""}," the ",-1)),ie(" "+B(k(Me)(n.state.configIndex+1))+" ",1),i[2]||(i[2]=v("span",{op50:""}," config item ",-1))])],64))]),n.isLocal?x("",!0):(p(),g("div",at,[r.value.files?(p(),g(S,{key:0},[i[5]||(i[5]=v("div",{"i-ph-file-magnifying-glass-duotone":"",my1:"","flex-none":"",op75:""},null,-1)),v("div",ut,[i[4]||(i[4]=v("div",{op50:""}," Applies to files matching ",-1)),v("div",ht,[(p(!0),g(S,null,H((f=r.value.files)==null?void 0:f.flat(),(y,_)=>(p(),O(u,{key:_,glob:y},null,8,["glob"]))),128))])])],64)):r.value.rules?(p(),g(S,{key:1},[i[6]||(i[6]=v("div",{"i-ph-files-duotone":"",my1:"","flex-none":"",op75:""},null,-1)),i[7]||(i[7]=v("div",{op50:""}," Applied generally for all files ",-1))],64)):x("",!0)])),(m=n.state.options)!=null&&m.length?(p(),g(S,{key:1},[i[8]||(i[8]=v("div",{flex:"~ gap-2 items-center"},[v("div",{"i-ph-sliders-duotone":"",my1:"","flex-none":"",op75:""}),v("div",{op50:""}," Rule options ")],-1)),(p(!0),g(S,null,H(n.state.options,(y,_)=>(p(),O(h,{key:_,lang:"ts",code:k(et)(y),rounded:"","bg-code":"",p2:"","text-sm":""},null,8,["code"]))),128))],64)):x("",!0)])}}}),dt={key:0,"max-h":"50vh"},pt={flex:"~ items-center gap-2",p3:""},ft={key:2,grid:"~ cols-2 items-center gap1",mx2:""},gt={key:0,"i-ph-check-square-duotone":"",op50:""},mt={key:1},yt={key:2,"i-ph-wrench-duotone":"",op50:""},vt={key:3},_t={key:0,border:"~ red/25 rounded","bg-red:5":"",px1:"","text-xs":"","text-red":""},xt={key:3,flex:"","flex-auto":"","flex-col":"","items-start":"","justify-end":""},Mt={flex:"~ gap-2",mt1:""},kt={key:0,border:"~ red/25 rounded","bg-red:5":"",px1:"","text-xs":"","text-red":""},bt={key:1,"i-ph-check-square-duotone":"",op50:""},It={key:2,"i-ph-wrench-duotone":"",op50:""},wt=W({__name:"RuleItem",props:{rule:{},ruleStates:{},value:{},class:{},gridView:{type:Boolean}},emits:["badgeClick","stateClick"],setup(t,{emit:e}){const s=t,r=e,{copy:o}=Ve();function l(n){return n&&n[0].toUpperCase()+n.slice(1)}return(n,i)=>{var m,y,_,$,I;const c=ke,a=be,u=je("VDropdown"),h=qe,f=ze;return p(),g(S,null,[n.ruleStates?(p(),g("div",{key:0,flex:"~ items-center gap-0.5 justify-end","text-lg":"",class:L(n.gridView?"absolute top-2 right-2 flex-col":"")},[(p(!0),g(S,null,H(n.ruleStates,(M,w)=>(p(),O(u,{key:w},{popper:N(({shown:R})=>[R?(p(),O(a,{key:0,state:M},null,8,["state"])):x("",!0)]),default:N(()=>{var R;return[K(c,{level:M.level,"config-index":M.configIndex,"has-options":!!((R=M.options)!=null&&R.length)},null,8,["level","config-index","has-options"])]}),_:2},1024))),128))],2)):x("",!0),n.value!=null?(p(),g("div",{key:1,class:L([s.class,n.gridView?"absolute top-2 right-2 flex-col":""])},[K(c,{level:k(Be)(n.value),"has-options":!!((m=k(We)(n.value))!=null&&m.length)},null,8,["level","has-options"])],2)):x("",!0),v("div",{class:L(s.class)},[K(u,{"inline-block":""},{popper:N(({shown:M})=>{var w;return[M?(p(),g("div",dt,[v("div",pt,[n.rule.invalid?x("",!0):(p(),O(f,{key:0,"btn-action-sm":"",to:(w=n.rule.docs)==null?void 0:w.url,target:"_blank",rel:"noopener noreferrer",title:"Docs"},{default:N(()=>i[2]||(i[2]=[v("div",{"i-ph-book-duotone":""},null,-1),ie(" Docs ")])),_:1},8,["to"])),v("button",{"btn-action-sm":"",title:"Copy",onClick:i[1]||(i[1]=R=>k(o)(n.rule.name))},i[3]||(i[3]=[v("div",{"i-ph-copy-duotone":""},null,-1),ie(" Copy name ")])),X(n.$slots,"popup-actions")]),X(n.$slots,"popup")])):x("",!0)]}),default:N(()=>[K(h,{name:n.rule.name,prefix:n.rule.plugin,deprecated:n.rule.deprecated,borderless:n.gridView,break:n.gridView,"text-start":"",as:"button",onClick:i[0]||(i[0]=M=>r("badgeClick",M))},null,8,["name","prefix","deprecated","borderless","break"])]),_:3})],2),n.gridView?x("",!0):(p(),g("div",ft,[(y=n.rule.docs)!=null&&y.recommended?Y((p(),g("div",gt,null,512)),[[k(J),"âœ… Recommended"]]):(p(),g("div",mt)),n.rule.fixable?Y((p(),g("div",yt,null,512)),[[k(J),"ðŸ”§ Fixable"]]):(p(),g("div",vt))])),v("div",{class:L(s.class),flex:"~ gap-2 items-center"},[v("div",{class:L([n.rule.deprecated?"line-through":"",n.rule.invalid?"text-red":"",n.gridView?"op50 text-sm":"op75 ws-nowrap of-hidden text-ellipsis line-clamp-1"])},B(n.rule.invalid?"Invalid rule has no description":l((_=n.rule.docs)==null?void 0:_.description)),3),!n.gridView&&(n.rule.invalid||n.rule.deprecated)?(p(),g("div",_t,B(n.rule.invalid?"INVALID":"DEPRECATED"),1)):x("",!0)],2),n.gridView&&(n.rule.invalid||n.rule.deprecated||n.rule.fixable||($=n.rule.docs)!=null&&$.recommended)?(p(),g("div",xt,[v("div",Mt,[n.rule.invalid||n.rule.deprecated?(p(),g("div",kt,B(n.rule.invalid?"INVALID":"DEPRECATED"),1)):x("",!0),(I=n.rule.docs)!=null&&I.recommended?Y((p(),g("div",bt,null,512)),[[k(J),"âœ… Recommended"]]):x("",!0),n.rule.fixable?Y((p(),g("div",It,null,512)),[[k(J),"ðŸ”§ Fixable"]]):x("",!0)])])):x("",!0)],64)}}}),gs=W({__name:"RuleList",props:{rules:{},getBind:{type:Function},filter:{type:Function}},setup(t){const e=t,s=P(()=>Array.isArray(e.rules)?e.rules.map(i=>i.name):Object.keys(e.rules)),r=function(i){return Array.isArray(e.rules)?e.rules.find(c=>c.name===i):He(i)},o=function(i){return Array.isArray(e.rules)?void 0:e.rules[i]},l=P(()=>te.value?"grid grid-cols-[repeat(auto-fill,minmax(min(100%,350px),1fr))] gap-2":(Array.isArray(e.rules),"grid grid-cols-[max-content_max-content_max-content_1fr] gap-x-2 gap-y-2 items-center")),n=W({setup(i,{slots:c}){return()=>{var a,u;return te.value?ne("div",{class:"relative border border-base max-w-full rounded-lg p4 py3 flex flex-col gap-2 of-hidden justify-start"},(a=c.default)==null?void 0:a.call(c)):ne(S,(u=c.default)==null?void 0:u.call(c))}}});return(i,c)=>{const a=be,u=wt;return p(),g("div",{class:L(l.value)},[(p(!0),g(S,null,H(s.value,h=>{var f;return p(),g(S,{key:h},[((f=e.filter)==null?void 0:f.call(e,h))!==!1?(p(),O(k(n),{key:0},{default:N(()=>{var m;return[K(u,Ke({rule:r(h),"rule-states":Array.isArray(i.rules)?k(re).ruleToState.get(h)||[]:void 0,"grid-view":k(te),value:o(h),ref_for:!0},(m=i.getBind)==null?void 0:m.call(i,h)),{popup:N(()=>[X(i.$slots,"popup",{ruleName:h,value:o(h)},()=>[(p(!0),g(S,null,H(k(re).ruleToState.get(h)||[],(y,_)=>(p(),O(a,{key:_,border:"t base",state:y},null,8,["state"]))),128))])]),"popup-actions":N(()=>[X(i.$slots,"popup-actions",{ruleName:h})]),_:2},1040,["rule","rule-states","grid-view","value"])]}),_:2},1024)):x("",!0)],64)}),128))],2)}}});function T(t){return Array.isArray?Array.isArray(t):Ee(t)==="[object Array]"}const Et=1/0;function St(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-Et?"-0":e}function At(t){return t==null?"":St(t)}function C(t){return typeof t=="string"}function Ie(t){return typeof t=="number"}function $t(t){return t===!0||t===!1||Rt(t)&&Ee(t)=="[object Boolean]"}function we(t){return typeof t=="object"}function Rt(t){return we(t)&&t!==null}function b(t){return t!=null}function se(t){return!t.trim().length}function Ee(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Lt="Incorrect 'index' type",Ct=t=>`Invalid value for key ${t}`,Nt=t=>`Pattern length exceeds max of ${t}.`,Ot=t=>`Missing ${t} property in key`,Tt=t=>`Property 'weight' in key '${t}' must be a positive integer`,me=Object.prototype.hasOwnProperty;class Ft{constructor(e){this._keys=[],this._keyMap={};let s=0;e.forEach(r=>{let o=Se(r);this._keys.push(o),this._keyMap[o.id]=o,s+=o.weight}),this._keys.forEach(r=>{r.weight/=s})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Se(t){let e=null,s=null,r=null,o=1,l=null;if(C(t)||T(t))r=t,e=ye(t),s=oe(t);else{if(!me.call(t,"name"))throw new Error(Ot("name"));const n=t.name;if(r=n,me.call(t,"weight")&&(o=t.weight,o<=0))throw new Error(Tt(n));e=ye(n),s=oe(n),l=t.getFn}return{path:e,id:s,weight:o,src:r,getFn:l}}function ye(t){return T(t)?t:t.split(".")}function oe(t){return T(t)?t.join("."):t}function Dt(t,e){let s=[],r=!1;const o=(l,n,i)=>{if(b(l))if(!n[i])s.push(l);else{let c=n[i];const a=l[c];if(!b(a))return;if(i===n.length-1&&(C(a)||Ie(a)||$t(a)))s.push(At(a));else if(T(a)){r=!0;for(let u=0,h=a.length;u<h;u+=1)o(a[u],n,i+1)}else n.length&&o(a,n,i+1)}};return o(t,C(e)?e.split("."):e,0),r?s:s[0]}const Pt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Vt={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},jt={location:0,threshold:.6,distance:100},Bt={useExtendedSearch:!1,getFn:Dt,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var d={...Vt,...Pt,...jt,...Bt};const Wt=/[^ ]+/g;function zt(t=1,e=3){const s=new Map,r=Math.pow(10,e);return{get(o){const l=o.match(Wt).length;if(s.has(l))return s.get(l);const n=1/Math.pow(l,.5*t),i=parseFloat(Math.round(n*r)/r);return s.set(l,i),i},clear(){s.clear()}}}class de{constructor({getFn:e=d.getFn,fieldNormWeight:s=d.fieldNormWeight}={}){this.norm=zt(s,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((s,r)=>{this._keysMap[s.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,C(this.docs[0])?this.docs.forEach((e,s)=>{this._addString(e,s)}):this.docs.forEach((e,s)=>{this._addObject(e,s)}),this.norm.clear())}add(e){const s=this.size();C(e)?this._addString(e,s):this._addObject(e,s)}removeAt(e){this.records.splice(e,1);for(let s=e,r=this.size();s<r;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(e,s){return e[this._keysMap[s]]}size(){return this.records.length}_addString(e,s){if(!b(e)||se(e))return;let r={v:e,i:s,n:this.norm.get(e)};this.records.push(r)}_addObject(e,s){let r={i:s,$:{}};this.keys.forEach((o,l)=>{let n=o.getFn?o.getFn(e):this.getFn(e,o.path);if(b(n)){if(T(n)){let i=[];const c=[{nestedArrIndex:-1,value:n}];for(;c.length;){const{nestedArrIndex:a,value:u}=c.pop();if(b(u))if(C(u)&&!se(u)){let h={v:u,i:a,n:this.norm.get(u)};i.push(h)}else T(u)&&u.forEach((h,f)=>{c.push({nestedArrIndex:f,value:h})})}r.$[l]=i}else if(C(n)&&!se(n)){let i={v:n,n:this.norm.get(n)};r.$[l]=i}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function Ae(t,e,{getFn:s=d.getFn,fieldNormWeight:r=d.fieldNormWeight}={}){const o=new de({getFn:s,fieldNormWeight:r});return o.setKeys(t.map(Se)),o.setSources(e),o.create(),o}function Kt(t,{getFn:e=d.getFn,fieldNormWeight:s=d.fieldNormWeight}={}){const{keys:r,records:o}=t,l=new de({getFn:e,fieldNormWeight:s});return l.setKeys(r),l.setIndexRecords(o),l}function Q(t,{errors:e=0,currentLocation:s=0,expectedLocation:r=0,distance:o=d.distance,ignoreLocation:l=d.ignoreLocation}={}){const n=e/t.length;if(l)return n;const i=Math.abs(r-s);return o?n+i/o:i?1:n}function Ht(t=[],e=d.minMatchCharLength){let s=[],r=-1,o=-1,l=0;for(let n=t.length;l<n;l+=1){let i=t[l];i&&r===-1?r=l:!i&&r!==-1&&(o=l-1,o-r+1>=e&&s.push([r,o]),r=-1)}return t[l-1]&&l-r>=e&&s.push([r,l-1]),s}const j=32;function Gt(t,e,s,{location:r=d.location,distance:o=d.distance,threshold:l=d.threshold,findAllMatches:n=d.findAllMatches,minMatchCharLength:i=d.minMatchCharLength,includeMatches:c=d.includeMatches,ignoreLocation:a=d.ignoreLocation}={}){if(e.length>j)throw new Error(Nt(j));const u=e.length,h=t.length,f=Math.max(0,Math.min(r,h));let m=l,y=f;const _=i>1||c,$=_?Array(h):[];let I;for(;(I=t.indexOf(e,y))>-1;){let E=Q(e,{currentLocation:I,expectedLocation:f,distance:o,ignoreLocation:a});if(m=Math.min(E,m),y=I+u,_){let F=0;for(;F<u;)$[I+F]=1,F+=1}}y=-1;let M=[],w=1,R=u+h;const Ne=1<<u-1;for(let E=0;E<u;E+=1){let F=0,D=R;for(;F<D;)Q(e,{errors:E,currentLocation:f+D,expectedLocation:f,distance:o,ignoreLocation:a})<=m?F=D:R=D,D=Math.floor((R-F)/2+F);R=D;let pe=Math.max(1,f-D+1),ee=n?h:Math.min(f+D,h)+u,z=Array(ee+2);z[ee+1]=(1<<E)-1;for(let A=ee;A>=pe;A-=1){let U=A-1,fe=s[t.charAt(U)];if(_&&($[U]=+!!fe),z[A]=(z[A+1]<<1|1)&fe,E&&(z[A]|=(M[A+1]|M[A])<<1|1|M[A+1]),z[A]&Ne&&(w=Q(e,{errors:E,currentLocation:U,expectedLocation:f,distance:o,ignoreLocation:a}),w<=m)){if(m=w,y=U,y<=f)break;pe=Math.max(1,2*f-y)}}if(Q(e,{errors:E+1,currentLocation:f,expectedLocation:f,distance:o,ignoreLocation:a})>m)break;M=z}const q={isMatch:y>=0,score:Math.max(.001,w)};if(_){const E=Ht($,i);E.length?c&&(q.indices=E):q.isMatch=!1}return q}function Ut(t){let e={};for(let s=0,r=t.length;s<r;s+=1){const o=t.charAt(s);e[o]=(e[o]||0)|1<<r-s-1}return e}class $e{constructor(e,{location:s=d.location,threshold:r=d.threshold,distance:o=d.distance,includeMatches:l=d.includeMatches,findAllMatches:n=d.findAllMatches,minMatchCharLength:i=d.minMatchCharLength,isCaseSensitive:c=d.isCaseSensitive,ignoreLocation:a=d.ignoreLocation}={}){if(this.options={location:s,threshold:r,distance:o,includeMatches:l,findAllMatches:n,minMatchCharLength:i,isCaseSensitive:c,ignoreLocation:a},this.pattern=c?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(f,m)=>{this.chunks.push({pattern:f,alphabet:Ut(f),startIndex:m})},h=this.pattern.length;if(h>j){let f=0;const m=h%j,y=h-m;for(;f<y;)u(this.pattern.substr(f,j),f),f+=j;if(m){const _=h-j;u(this.pattern.substr(_),_)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:s,includeMatches:r}=this.options;if(s||(e=e.toLowerCase()),this.pattern===e){let y={isMatch:!0,score:0};return r&&(y.indices=[[0,e.length-1]]),y}const{location:o,distance:l,threshold:n,findAllMatches:i,minMatchCharLength:c,ignoreLocation:a}=this.options;let u=[],h=0,f=!1;this.chunks.forEach(({pattern:y,alphabet:_,startIndex:$})=>{const{isMatch:I,score:M,indices:w}=Gt(e,y,_,{location:o+$,distance:l,threshold:n,findAllMatches:i,minMatchCharLength:c,includeMatches:r,ignoreLocation:a});I&&(f=!0),h+=M,I&&w&&(u=[...u,...w])});let m={isMatch:f,score:f?h/this.chunks.length:1};return f&&r&&(m.indices=u),m}}class V{constructor(e){this.pattern=e}static isMultiMatch(e){return ve(e,this.multiRegex)}static isSingleMatch(e){return ve(e,this.singleRegex)}search(){}}function ve(t,e){const s=t.match(e);return s?s[1]:null}class Yt extends V{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const s=e===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class Jt extends V{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class Qt extends V{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const s=e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class Xt extends V{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const s=!e.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class Zt extends V{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const s=e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class qt extends V{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const s=!e.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class Re extends V{constructor(e,{location:s=d.location,threshold:r=d.threshold,distance:o=d.distance,includeMatches:l=d.includeMatches,findAllMatches:n=d.findAllMatches,minMatchCharLength:i=d.minMatchCharLength,isCaseSensitive:c=d.isCaseSensitive,ignoreLocation:a=d.ignoreLocation}={}){super(e),this._bitapSearch=new $e(e,{location:s,threshold:r,distance:o,includeMatches:l,findAllMatches:n,minMatchCharLength:i,isCaseSensitive:c,ignoreLocation:a})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Le extends V{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let s=0,r;const o=[],l=this.pattern.length;for(;(r=e.indexOf(this.pattern,s))>-1;)s=r+l,o.push([r,s-1]);const n=!!o.length;return{isMatch:n,score:n?0:1,indices:o}}}const le=[Yt,Le,Qt,Xt,qt,Zt,Jt,Re],_e=le.length,es=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ts="|";function ss(t,e={}){return t.split(ts).map(s=>{let r=s.trim().split(es).filter(l=>l&&!!l.trim()),o=[];for(let l=0,n=r.length;l<n;l+=1){const i=r[l];let c=!1,a=-1;for(;!c&&++a<_e;){const u=le[a];let h=u.isMultiMatch(i);h&&(o.push(new u(h,e)),c=!0)}if(!c)for(a=-1;++a<_e;){const u=le[a];let h=u.isSingleMatch(i);if(h){o.push(new u(h,e));break}}}return o})}const ns=new Set([Re.type,Le.type]);class rs{constructor(e,{isCaseSensitive:s=d.isCaseSensitive,includeMatches:r=d.includeMatches,minMatchCharLength:o=d.minMatchCharLength,ignoreLocation:l=d.ignoreLocation,findAllMatches:n=d.findAllMatches,location:i=d.location,threshold:c=d.threshold,distance:a=d.distance}={}){this.query=null,this.options={isCaseSensitive:s,includeMatches:r,minMatchCharLength:o,findAllMatches:n,ignoreLocation:l,location:i,threshold:c,distance:a},this.pattern=s?e:e.toLowerCase(),this.query=ss(this.pattern,this.options)}static condition(e,s){return s.useExtendedSearch}searchIn(e){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:o}=this.options;e=o?e:e.toLowerCase();let l=0,n=[],i=0;for(let c=0,a=s.length;c<a;c+=1){const u=s[c];n.length=0,l=0;for(let h=0,f=u.length;h<f;h+=1){const m=u[h],{isMatch:y,indices:_,score:$}=m.search(e);if(y){if(l+=1,i+=$,r){const I=m.constructor.type;ns.has(I)?n=[...n,..._]:n.push(_)}}else{i=0,l=0,n.length=0;break}}if(l){let h={isMatch:!0,score:i/l};return r&&(h.indices=n),h}}return{isMatch:!1,score:1}}}const ce=[];function is(...t){ce.push(...t)}function ae(t,e){for(let s=0,r=ce.length;s<r;s+=1){let o=ce[s];if(o.condition(t,e))return new o(t,e)}return new $e(t,e)}const Z={AND:"$and",OR:"$or"},ue={PATH:"$path",PATTERN:"$val"},he=t=>!!(t[Z.AND]||t[Z.OR]),os=t=>!!t[ue.PATH],ls=t=>!T(t)&&we(t)&&!he(t),xe=t=>({[Z.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function Ce(t,e,{auto:s=!0}={}){const r=o=>{let l=Object.keys(o);const n=os(o);if(!n&&l.length>1&&!he(o))return r(xe(o));if(ls(o)){const c=n?o[ue.PATH]:l[0],a=n?o[ue.PATTERN]:o[c];if(!C(a))throw new Error(Ct(c));const u={keyId:oe(c),pattern:a};return s&&(u.searcher=ae(a,e)),u}let i={children:[],operator:l[0]};return l.forEach(c=>{const a=o[c];T(a)&&a.forEach(u=>{i.children.push(r(u))})}),i};return he(t)||(t=xe(t)),r(t)}function cs(t,{ignoreFieldNorm:e=d.ignoreFieldNorm}){t.forEach(s=>{let r=1;s.matches.forEach(({key:o,norm:l,score:n})=>{const i=o?o.weight:null;r*=Math.pow(n===0&&i?Number.EPSILON:n,(i||1)*(e?1:l))}),s.score=r})}function as(t,e){const s=t.matches;e.matches=[],b(s)&&s.forEach(r=>{if(!b(r.indices)||!r.indices.length)return;const{indices:o,value:l}=r;let n={indices:o,value:l};r.key&&(n.key=r.key.src),r.idx>-1&&(n.refIndex=r.idx),e.matches.push(n)})}function us(t,e){e.score=t.score}function hs(t,e,{includeMatches:s=d.includeMatches,includeScore:r=d.includeScore}={}){const o=[];return s&&o.push(as),r&&o.push(us),t.map(l=>{const{idx:n}=l,i={item:e[n],refIndex:n};return o.length&&o.forEach(c=>{c(l,i)}),i})}class G{constructor(e,s={},r){this.options={...d,...s},this.options.useExtendedSearch,this._keyStore=new Ft(this.options.keys),this.setCollection(e,r)}setCollection(e,s){if(this._docs=e,s&&!(s instanceof de))throw new Error(Lt);this._myIndex=s||Ae(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){b(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const s=[];for(let r=0,o=this._docs.length;r<o;r+=1){const l=this._docs[r];e(l,r)&&(this.removeAt(r),r-=1,o-=1,s.push(l))}return s}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:s=-1}={}){const{includeMatches:r,includeScore:o,shouldSort:l,sortFn:n,ignoreFieldNorm:i}=this.options;let c=C(e)?C(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return cs(c,{ignoreFieldNorm:i}),l&&c.sort(n),Ie(s)&&s>-1&&(c=c.slice(0,s)),hs(c,this._docs,{includeMatches:r,includeScore:o})}_searchStringList(e){const s=ae(e,this.options),{records:r}=this._myIndex,o=[];return r.forEach(({v:l,i:n,n:i})=>{if(!b(l))return;const{isMatch:c,score:a,indices:u}=s.searchIn(l);c&&o.push({item:l,idx:n,matches:[{score:a,value:l,norm:i,indices:u}]})}),o}_searchLogical(e){const s=Ce(e,this.options),r=(i,c,a)=>{if(!i.children){const{keyId:h,searcher:f}=i,m=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(c,h),searcher:f});return m&&m.length?[{idx:a,item:c,matches:m}]:[]}const u=[];for(let h=0,f=i.children.length;h<f;h+=1){const m=i.children[h],y=r(m,c,a);if(y.length)u.push(...y);else if(i.operator===Z.AND)return[]}return u},o=this._myIndex.records,l={},n=[];return o.forEach(({$:i,i:c})=>{if(b(i)){let a=r(s,i,c);a.length&&(l[c]||(l[c]={idx:c,item:i,matches:[]},n.push(l[c])),a.forEach(({matches:u})=>{l[c].matches.push(...u)}))}}),n}_searchObjectList(e){const s=ae(e,this.options),{keys:r,records:o}=this._myIndex,l=[];return o.forEach(({$:n,i})=>{if(!b(n))return;let c=[];r.forEach((a,u)=>{c.push(...this._findMatches({key:a,value:n[u],searcher:s}))}),c.length&&l.push({idx:i,item:n,matches:c})}),l}_findMatches({key:e,value:s,searcher:r}){if(!b(s))return[];let o=[];if(T(s))s.forEach(({v:l,i:n,n:i})=>{if(!b(l))return;const{isMatch:c,score:a,indices:u}=r.searchIn(l);c&&o.push({score:a,key:e,value:l,idx:n,norm:i,indices:u})});else{const{v:l,n}=s,{isMatch:i,score:c,indices:a}=r.searchIn(l);i&&o.push({score:c,key:e,value:l,norm:n,indices:a})}return o}}G.version="7.0.0";G.createIndex=Ae;G.parseIndex=Kt;G.config=d;G.parseQuery=Ce;is(rs);export{G as F,be as _,gs as a,nt as b,qe as c,ke as d,et as s};
